---
layout: post
title: üá™üá∏ Bizarro banking trojan report
author: voidm4p
date: 2021-06-22 09:00:00
categories:
- malware
tags:
- bizarro
- windows
- Delphi
- AutoIt
toc: true
---
 
# An√°lisis Troyano Bizarro 

**Bizarro**, nombrado as√≠ por los investigadores de *securelist* de <a href="https://securelist.com/bizarro-banking-trojan-expands-its-attacks-to-europe/102258/" target="_blank">Kaspersky</a>, es un troyano bancario procedente de Brasil y cuyo objetivo se expande a usuarios de diferentes pa√≠ses de Europa y Am√©rica Latina, incluidos Espa√±a y Portugal. Esta familia pertenece a los llamados *Tetrade*, entre los que se encuentra *Mekotio*, tambi√©n conocido como *Metamorfo*, *Casbaneiro* o *N40*, con el que parece tener una estrecha relaci√≥n, pues tras el an√°lisis realizado todo parece indicar que se tratan del mismo troyano con peque√±as modificaciones o, al menos, una versi√≥n del mismo.  
 
Los operadores de este malware, llamados *Rooty Dolphin* por el equipo de <a href="https://securityboulevard.com/2020/09/rooty-dolphin-uses-mekotio-to-target-bank-clients-in-south-america-and-europe/" target="_blank">Blueliv</a> parece hacer uso de servidores de Azure y Amazon, as√≠ como sitios web con frameworks como Wordpress que son vulnerados para almacenar las piezas del malware. 
 
Este troyano es distribuido mediante paquetes de tipo MSI que son descargados a trav√©s de un enlace contenido en correos electr√≥nicos fraudulentos. Tras la ejecuci√≥n de este fichero MSI, se produce una nueva descarga, en este caso de un fichero comprimido ZIP que, en funci√≥n de la arquitectura del SO se tratar√° de una versi√≥n de 32 o de 64 bits del troyano. 
 
La principal funcionalidad de este malware es la de capturar credenciales de acceso a aplicaciones bancarias, lo cual logra mediante la enumeraci√≥n de las ventanas abiertas por el usuario, as√≠ como interceptar operaciones relacionadas con carteras de Bitcoin, sustituyendo en memoria las direcciones copiadas por la de los atacantes. Adem√°s, incluye funcionalidades de Remote Access Trojan (RAT), lo que permite a los atacantes obtener un acceso pr√°cticamente completo del equipo infectado. Esta funcionalidad parece estar basada en el c√≥digo fuente del proyecto ‚ÄúDelphi Remote Access‚Äù que puede encontrarse en <a href="https://github.com/Maickonn/Delphi_Remote_Access_PC/" target="_blank">Github</a>, donde puede apreciarse una sintaxis muy similar en los comandos enviados por el malware.
 
 
## AN√ÅLISIS T√âCNICO 
La muestra analizada es uno de los ficheros ZIP descargados, presuntamente, desde un instalador MSI como los descritos anteriormente, pese a que no ha sido posible localizar dicho paquete. Su hash SHA256 es: f57fc4857a76fe66cb8eb0bbc9e88d9e70f9de2135d4802c7c18f89bd92060a9.

Este comprimido contiene en su interior diferentes ficheros entre los que se encuentran el int√©rprete de AutoIt, un script AutoIt cifrado, la librer√≠a SQLite y la propia DLL del troyano. 

Una vez descomprimidos, los hashes de los ficheros en el ZIP de Bizarro son los siguientes:

| SHA-256                                                          | Nombre                                | Tipo |
| ---------------------------------------------------------------- | ------------------------------------- | ---- | 
| d14c9923a76dd83cf9149289cc16fa6d8bf950a29fb96c21455ecc4007e560d2 | sqlite3.dll                           | PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, UPX compressed |
| 89922e55532bc71d1b512c313913fed7d0000db3e2817f4345734431c9755b7d | T0S8HTPUS036PVXE6D331IP0XP8F439Y50EWK | PE32 executable (DLL) (GUI) Intel 80386, for MS Windows |
| 237d1bca6e056df5bb16a1216a434634109478f882d3b1d58344c801d184f95d | W949Z6FZAC9O47WQ28KE2V7LHZ19NB5KUK    | PE32 executable (GUI) Intel 80386, for MS Windows |
| 86b201fbbebd2e882d1b6884538f6057bfaec08598a8ebf2a3c56fa9d33b43e4 | ZD1MWY9LAC0WU8D9ZQQU2WKWSBDSLJUCTNWBI | data 
 
### Script AutoIt 
El siguiente gr√°fico de Eset ejemplifica la cadena completa de infecci√≥n de este malware:

![Image 8](/assets/img/posts/bizarro-2021/img04_08.jpg)

Tras revisar el binario "W949Z6FZAC9O47WQ28KE2V7LHZ19NB5KUK" se comprueba que 
se trata del cargador de AutoIt, un lenguaje de programaci√≥n cuyos scripts pueden ser convertidos en binarios gracias a este fichero. 

En funci√≥n de la versi√≥n de AutoIt, el script se almacena con diferentes sistemas de protecci√≥n.  

![Image 10](/assets/img/posts/bizarro-2021/img05_10.png)

 
En este caso, el fichero "ZD1MWY9LAC0WU8D9ZQQU2WKWSBDSLJUCTNWBI" es el script 
cifrado que se encuentra fuera del binario y, haciendo uso de la herramienta Exe2Auto e indicando la ruta al fichero del script cifrado es posible visualizar su contenido.

![Image 11](/assets/img/posts/bizarro-2021/img05_11.png)

El script AutoIt indica que el programa no debe tener *Tray Icon*, con el objetivo de permanecer oculto. A continuaci√≥n realiza una pausa de 8 segundos, utilizando para ello la funci√≥n `Sleep` del propio lenguaje y una implementaci√≥n propia que hace uso de la funci√≥n hom√≥nima de la librer√≠a *Kernel32.dll*. Tras esto, lee los argumentos facilitados al programa a trav√©s de l√≠nea de comandos, donde se le debe indicar la ruta de la DLL del malware que es ejecutada llamando, en este caso a la funci√≥n exportada "VKNBSSG8GNSHI2E5RS2NPYS6JPNIA8".

### DLL Bizarro 
Esta librer√≠a es el fichero "T0S8HTPUS036PVXE6D331IP0XP8F439Y50EWK" que se 
encuentra dentro del ZIP anterior. La librer√≠a se trata de un binario de 32 bits programada en el lenguaje Delphi. 

![Image 13](/assets/img/posts/bizarro-2021/img06_13.jpg)

Entre las funciones exportadas por dicha librer√≠a se encuentra el nombre utilizado por el script AutoIt por lo que se confirma que es el c√≥digo del malware final a ejecutar. 

![Image 14](/assets/img/posts/bizarro-2021/img06_14.png)
 
Al llamar a esta funci√≥n, el c√≥digo empieza a ejecutarse desde aqu√≠, obviando las instrucciones del EntryPoint a no ser que este sea llamado expl√≠citamente por el c√≥digo de esta funci√≥n.

Para poder analizar correctamente este malware se hace uso del software Interactive Delphi Reconstructor (IDR), gracias al cual se puede localizar la direcci√≥n del formulario principal utilizado por el troyano y que es inicializado en esta funci√≥n.

![Image 16](/assets/img/posts/bizarro-2021/img07_16.jpg)

Tras inspeccionar en detalle este formulario en el IDR, se pueden descubrir el resto de funcionalidades contenidas en el malware cuyos nombres parecen ser aleatorios, por lo que seguramente hayan sido tratados por alg√∫n software que los renombre con el fin de dificultar la tarea de an√°lisis. A√∫n as√≠, se aprecian algunos nombres interesantes como "`Connect`", "`Disconnect`" y diferentes m√©todos asociados a "`Timer`". 

![Image 17](/assets/img/posts/bizarro-2021/img07_17.jpg)

#### Algoritmo de cifrado de cadena de caracteres 
Prestando atenci√≥n a la funci√≥n `FormCreate`, se puede comprobar que las cadenas de caracteres utilizadas por el troyano han sido ofuscadas mediante cierto algoritmo de cifrado. Tras revisar el c√≥digo, se puede localizar una llamada a cierta funci√≥n que es muy utilizada y a la que se le pasa cada ve z cierta cadena de caracteres. Esta es la funci√≥n encargada de descifrar las cadenas.

![Image 18](/assets/img/posts/bizarro-2021/img07_18.png)

Tras investigar el algoritmo utilizado, se puede concluir que se trata de la misma implementaci√≥n utilizada por el malware Mekotio. De hecho, todo parece indicar que este troyano no es m√°s que una versi√≥n del propio Mekotio, pues todo lo descrito anteriormente coincide con los an√°lisis realizados de este malware.

Inspeccionando la rutina se puede comprobar como dentro de esta hay una llamada a una segunda subrutina que hace uso de la operaci√≥n XOR con un valor del stack. 

![Image 20](/assets/img/posts/bizarro-2021/img08_20.png)

La clave utilizada por el algoritmo es siempre la misma y se encuentra hardcodeada en la configuraci√≥n del formulario principal "5VANV4SDMC3VEAFR8S2M3M9U6WRH3P7FDD9T9Q10IAG5WZJ5K5". 

![Image 21](/assets/img/posts/bizarro-2021/img08_21.png)
![Image 23](/assets/img/posts/bizarro-2021/img09_23.png)
![Image 24](/assets/img/posts/bizarro-2021/img09_24.png)
 
 
Inspeccionando el algoritmo utilizado, se comprueba que se recorre la cadena de 
caracteres cifrada en pares de caracteres, convirtiendo √©stos a su representaci√≥n en hexadecimal (ej. "9A" = 0x9A). Se comienza realizando la operaci√≥n XOR entre el hexadecimal del primer car√°cter de la clave ('5' = 0x35) con el segundo par de caracreres tratados como hexacimal. A este valor se le resta la representaci√≥n hexadecimal del primer par de caracteres y, si el resultado es negativo, se convierte a positivo a√±adiendo 0xFF y se convierte a car√°cter. Esta operaci√≥n se repite para cada par de valores de la cadena 
cifrada.

Para m√°s detalles sobre este algoritmo de cifrado pueden consultarse diferentes 
investigaciones sobre Mekotio:

- <a href="https://reversea.me/index.php/reverse-engineering-the-string-decryption-algorithm-of-mekotio/" target="_blank">https://reversea.me/index.php/reverse-engineering-the-string-decryption-algorithm-of-mekotio/</a>
- <a href="https://disassemble.blog/2018/07/14/deobfuscating-strings-with-idapython/" target="_blank">https://disassemble.blog/2018/07/14/deobfuscating-strings-with-idapython/</a>

Para poder analizar el c√≥digo correctamente, se ha hecho uso de un script de IDA adaptado para poder ser ejecutado sobre la muestra que se est√° estudiando.

```python
import idaapi, idc, idautils, re, json 
  
def GetString(instr): 
    chars = [] 
    count = 0 
    while(Byte(instr+count)): 
        chars.append(chr(Byte(instr+count))) 
        count+=1 
    return "".join(chars) 
  
def IsAddress(instr): 
    pattern = re.compile("5[a-fA-F0-9]{7}")  # Check for each sample 
    if not pattern.match(instr): 
        return False 
    return True 
  
def DecodeString(encodedString): 
    key = "5VANV4SDMC3VEAFR8S2M3M9U6WRH3P7FDD9T9Q10IAG5WZJ5K5" # paste the password here 
    keyLen = len(key) 
    encStrLen = len(encodedString) 
    prevEncodedByte = 0 
    encStrList = [] 
    keyList = [] 
  
    encodedString = [encodedString[i:i+2] for i in range(0, encStrLen, 2)] 
    for byte in encodedString: 
        encStrList.append(int(byte, 16)) 
  
    key = [key[i] for i in range(0, keyLen, 1)] 
    for byte in key: 
        keyList.append(ord(byte)) 
  
    prevEncodedByte = encStrList[0] 
  
    encStrLen = len(encStrList) 
    keyLen = len(keyList) 
    keyOffset = 0 
  
    decodedString = [] 
    for i in range(1,encStrLen): 
        if(keyOffset>=keyLen): 
            keyOffset = 0 
        decodedByte = encStrList[i] ^ keyList[keyOffset] 
        if(decodedByte>prevEncodedByte): 
            decodedByte -= prevEncodedByte 
        else: 
            decodedByte = decodedByte + 0xFF - prevEncodedByte 
        prevEncodedByte = encStrList[i] 
        decodedString.append(chr(decodedByte)) 
  
        keyOffset += 1 
  
    return("".join(decodedString)) 
# =========================================================================== 
# =========================================================================== 
funcName = LocByName('sub_56FEB41C') 
funcXrefs = CodeRefsTo(funcName,1) 
strings = [] 
  
for xref in funcXrefs: 
    intructs = 0 
    tempInstr = xref 
    while(intructs==0): 
        tempInstr = PrevHead(tempInstr,SegStart(tempInstr)) 
        mnem = GetMnem(tempInstr) 
        if(mnem == 'mov'): 
            intructs = tempInstr 
        else: 
            continue 
  
    encodedStrAddr = GetOperandValue(intructs,1) 
  
    if(IsAddress("{:08X}".format(encodedStrAddr))): 
        encodedStr = GetString(encodedStrAddr) 
        print(encodedStr) 
        decodedStr = DecodeString(encodedStr) 
        print('CALL @ {:08X} with \"{}\" -> \"{}\"'.format(xref,encodedStr,decodedStr)) 
        MakeComm(xref,''.join(decodedStr)) 
  
print("FIN") 
```

Gracias a este script es posible visualizar las cadenas de caracteres en el propio c√≥digo ensamblador.

![Image 27](/assets/img/posts/bizarro-2021/img11_27.jpg)
 
#### Configuraci√≥n 
Por otra parte, prosiguiendo con el an√°lisis del c√≥digo del formulario de inicializaci√≥n, se puede observar que se encarga de inicializar una serie de variables globales con cadenas cifradas de igual manera que las anteriores. Al tratarse de variables globales, seguramente sean descifradas m√°s tarde en tiempo de ejecuci√≥n, por lo que el script de IDA anterior no las ha descifrado autom√°ticamente. Por tanto, en este caso se descifran manualmente 
haciendo uso del mismo algoritmo. 

![Image 29](/assets/img/posts/bizarro-2021/img12_29.jpg)

A continuaci√≥n se incluyen las cadenas encontradas en este formulario:

```
http://18.209.163.113/cont/puma.php 
novasactua.ddns.net 
9988 
SCOT01--08-11 
1Pxq1yNJXzM5w5VxtAxGJsUD6wj3uKHiLr 
https://docs.google.com/document/d/1LLACzprTYW_XIcVGrOW37mo7IjLgyG-6KFAy_51418/export?format=txt 
https://zspbialobrzegi.edu.pl/html/plany/s14.php 
```

Para poder conectar con la direcci√≥n DDNS, el troyano utiliza un comando del sistema operativo encargado de borrar los datos de cach√© DNS, de forma que pueda obtenerse la direcci√≥n actual. Sin embargo, en el momento de an√°lisis, el DNS de Google 8.8.8.8 responde con la direcci√≥n 0.0.0.0 para esta direcci√≥n. 

![Image 30](/assets/img/posts/bizarro-2021/img12_30.png)

La cadena ‚ÄúSCOT01 --08-11‚Äù parece corresponder con la versi√≥n del malware que es 
utilizada para identificar las diferentes campa√±as. 

#### Monedero Bitcoin 
Entre las cadenas, tambi√©n se encuentra lo que parece ser una direcci√≥n de Bitcoin. Tras comprobar el valor de la direcci√≥n se puede comprobar que su saldo actual es de 600$.

![Image 32](/assets/img/posts/bizarro-2021/img13_32.png)
 
#### Inicializaci√≥n 
A partir de aqu√≠, una vez realizada la inicializaci√≥n, el troyano comienza sus operaciones. En primer lugar, obtiene la versi√≥n del SO y, en funci√≥n de √©sta, almacena un valor de forma interna.

![Image 33](/assets/img/posts/bizarro-2021/img13_33.jpg)

Tambi√©n recopila informaci√≥n como el nombre del equipo, el nombre predeterminado del navegador y el nombre del software antivirus instalado. 

![Image 35](/assets/img/posts/bizarro-2021/img14_35.png)

Para asegurar la ejecuci√≥n exclusiva del malware, comprueba la existencia de dos ficheros, "bizarro.txt" y otro con el nombre del binario utilizado para cargar la DLL seguido de la extensi√≥n .jkl, cre√°ndose en caso de que no existan a√∫n. Tambi√©n trata de detener los procesos en ejecuci√≥n de algunos de los principales navegadores de Internet.

![Image 36](/assets/img/posts/bizarro-2021/img14_36.png)
 
Por otra parte, tambi√©n accede al registro de Windows para desactivar a trav√©s de las claves "Use FormSuggest" y "FormSuggest Passwords" de la ruta 
`Software\Policies\Microsoft\Internet Explorer\Main` algunas funcionalidades de los exploradores como el auto-completado y sugerencias de formularios. 

![Image 38](/assets/img/posts/bizarro-2021/img15_38.png)
 
Adem√°s, hace uso de la librer√≠a sqlite3.dll incluida en el comprimido ZIP para extraer las contrase√±as almacenadas en el navegador Chrome. 

![Image 39](/assets/img/posts/bizarro-2021/img15_39.png)

#### Comunicaci√≥n 
El protocolo para comunicarse con la direcci√≥n del C2 que utiliza DDNS parece ser TCP, abriendo un socket con el puerto 9988. Dado que la direcci√≥n no resuelve a ninguna direcci√≥n IP v√°lida en el momento de an√°lisis (0.0.0.0), se ha generado un simple servidor TCP para poder visualizar la comunicaci√≥n llevada a cabo por este troyano. A continuaci√≥n puede observarse los mensajes correspondientes al primer contacto con el C2 donde a la petici√≥n de √≥rdenes "<|QFUNHSNXU|>" el servidor responde con "<|PT|>" y el  malware env√≠a la informaci√≥n del sistema infectado.

![Image 41](/assets/img/posts/bizarro-2021/img16_41.jpg)
 
Tras enviar esta informaci√≥n, se inicia el m√≥dulo de captura de pantalla para lo cual carga la librer√≠a magnification.dll y obtiene la direcci√≥n de la API MagSetImageScalingCallback (marcada como deprecated a partir de <a href="https://docs.microsoft.com/en-us/windows/win32/api/magnification/nf-magnification-magsetimagescalingcallback" target="_blank">Windows 7</a>). Mediante esta funci√≥n, el troyano puede capturar la pantalla del usuario y tambi√©n hacer un monitoreo constante del portapapeles del sistema mediante SetClipboardData. 

![Image 42](/assets/img/posts/bizarro-2021/img16_42.png)

 
Bizarro tiene la capacidad de detectar el acceso a los sistemas de banca en l√≠nea. Para ello, identifica las ventanas abiertas, recopilando sus nombres. De esta forma, si el malware identifica el nombre de una ventana que coincide con una palabra que tenga  configurada, prosigue sus operaciones para tratar de robar las credenciales del usuario. 

![Image 44](/assets/img/posts/bizarro-2021/img17_44.jpg)

Adem√°s, el malware incluye la funcionalidad de RAT, de forma que su comportamiento depende de lo que se le ordene desde el C2. El backdoor contiene gran cantidad de comandos y la mayor√≠a de ellos se utilizan para mostrar mensajes emergentes falsos a los us uarios. El listado de comandos que puede recibir es el siguiente:

```
"<|YuiqkwSgot|>", "<|PT|>", "<|VOTM|>", "<|Gpsxi|>", "<|ZKXAKYWQKEHUGZJ|>", "<|lozyw|>", "<|SuaykRJ|>", "<|SuaykJI|>", "<|ztUjzwtR|>", "<|IXjzwtR|>", "<|Folder|>", "<|Files|>", "<|DownloadFile|>", "<|UploadFile|>", "dkxqdpdv", "fuobhjh", "pyfsqtpofn", "camarinho", "beijada", "cidadao", "dlulztody", "janainaa", "nnnaewhwf23nvcxx", "vanuza", "vanessa", "carmena", "petereca", "jpevtpjevtjte", "djqduidxorv", "dulhkqzprf", "vaidamole", "vadiadaum", "lzyxyzoxzdy", "baraomagao", "IbqJxbxma", "Lmatqo", "puplY", "hajluvjlY", "wlylajhyhJ", "gsxuymrle", "sjemwbgonehjexhjjexhjxh", "phjdqdfdv", "madona", LkingWajuGhkzwu", 
"vkbAlcvtlY", "JtxyXLWA", "urpdzchlrdi", "JXyhylipS", "ndsoiu43098s", snis4duo3098", "ki74yfhsag", "KxvoJJ", "Bwilmakx", "semvergonha", "mh42jkrxc3", "BwiAivbi", "vBiAiiwbwew", "Bwiqbi", "kdaf4w84fds", "iru4837fbcz", "apqi398wjx", "Bwiaqk", "mfklsjfk3049jsfd", "Bwikmn", "vpupqbd", "ulrvAkhyI", "posseco", "jpwhslAzvsI", "ihAhaP", "dsefsdfds342342", "massonaria", "kldiu4324987dyyds", "iejdskdjkfl3426232hdshdhs", "maconha", "cnirhx87ds", "b9f8vnh3f7dhvsja4", "ihAwpMhauhW", "nhfjds98743hvfavb", "mfki73t1dav", "fodiufjdo834yfdgf", "f9ksa8iuvdo", "miwey82fqq", "oropeiru23", "kmcjds09498", "ewaewqrtrrmwoa", "m94ufasjczbal", "ulzcecrvAkhocpgyI", "hslfasreweyI", "perebao", "japones3fadhh", "uhkozphslAzvsI", "HruxWkrgHHMqgbkgs", "kxsHqddeuMHgHrbgrWgk", "bisurdor", "curvaduru", "vvjpwulw", "bosteiro", "lkfjasofu4343849", "fkvoiudas98", "coichzbz", "b98djzc", "klfjs943jfs", "eaqeutmn5r", "cracreuz", "guilhermina", "ztchrhAhaP", "IIzvsI", "HAPzvsI", "juventude", "HAUHWzvsI", "KHYIzvsI", "jpwzvsI", "mljzvsI", "hruxyoiu", "COZUMEL", "COZUMARIA", "LMAimwc", "baci83427daca", "daa243bi78acc" 
```

A continuaci√≥n se describen algunos de los comandos m√°s interesantes: 

- **`<|PT|>`** env√≠a la informaci√≥n del perfil del equipo infectado al C2 que incluye la versi√≥n de Bizarro, el nombre del sistema operativo, el nombre del equipo del usuario, el identificador √∫nico de Bizarro, el software antivirus instalado y el nombre cifrado del banco al que se ha accedido. Los nombres cifrados son nombres de banco escritos en leet speak.

![Image 46](/assets/img/posts/bizarro-2021/img18_46.png) 
 
- **`<|DownloadFile|>`** descarga archivos en el equipo de la v√≠ctima. 
- **`<|UploadFile|>`** permite a los atacantes obtener archivos del equipo del usuario. 
- **`<|Folder|>`** y **`<|File|>`** permiten a los atacantes buscar carpetas y archivos que tienen 
determinado nombre. 
- **`<|SuaykRJ|>`** realiza un clic izquierdo del bot√≥n del rat√≥n en la posici√≥n indicada. 
- **`<|SuaykJI|>`** realiza un doble clic en la ubicaci√≥n indicada,  
- **`<|IXjzwtR|>`** realiza un clic con el bot√≥n derecho del rat√≥n.  
- **`<|ztUjzwtR|>`** mueve el rat√≥n a una ubicaci√≥n indicada.  
    - La sintaxis de estos tres comandos es `<|comandad name|>x coordinate<|>y coordinate<<|`. 
- **`carmena`** permite escribir el texto indicado simulando pulsaciones de teclado. 
- **`LkingWajuGhkzwu`** finaliza la ejecuci√≥n del troyano. 
- **`vkbAlcvtlY`** descarga y ejecuta un archivo .bat pensado para borrar ficheros 
- **`COZUMEL`** activa el keylogger 
- **`COZUMARIA`** desactiva el keylogger 
- **`dkxqdpdv`**, **`vanessa`**, **`LMAimwc`** muestran diferentes mensajes para incitar al usuario a introducir sus credenciales. 

![Image 48](/assets/img/posts/bizarro-2021/img19_48.png)

- Comandos como **`Bwikmn`** permiten a los atacantes congelar el sistema operativo y mostrar la ventana que indiquen, como por ejemplo mensajes falsos de sistemas bancarios. Cuando se recibe este mensaje la barra de tareas se oculta, la pantalla se aten√∫a y entonces es cuando se mue stra el mensaje. Para ello, tras recibir la orden, el troyano necesita descargar  una imagen con el logo del banco e instrucciones para el usuario.

Dado que en el momento del an√°lisis el C2 no se encuentra disponible, si se trata de emular este comando, la ventana se ver√° en blanco.

![Image 49](/assets/img/posts/bizarro-2021/img19_49.jpg)

A continuaci√≥n se muestra un ejemplo de c√≥mo se ver√≠a en caso de poder descargarse el contenido del C2 extra√≠do del an√°lisis de securelist. 

![Image 51](/assets/img/posts/bizarro-2021/img20_51.png)
 
Para m√°s informaci√≥n sobre el protocolo de comunicaci√≥n utilizado por Mekotio pueden consultarse an√°lisis como el realizado por Fortinet donde se detallan m√°s exhaustivamente cada uno de los comandos que puede recibir el <a href="https://www.fortinet.com/blog/threat-research/another-metamorfo-variant-targeting-customers-of-financial-institutions" target="_blank">troyano</a>. 

## IOC
```
f57fc4857a76fe66cb8eb0bbc9e88d9e70f9de2135d4802c7c18f89bd92060a9 
89922e55532bc71d1b512c313913fed7d0000db3e2817f4345734431c9755b7d 
86b201fbbebd2e882d1b6884538f6057bfaec08598a8ebf2a3c56fa9d33b43e4 
http://18.209.163.113/cont/puma.php 
novasactua.ddns.net:9988 
https://docs.google.com/document/d/1LLACzprTYW_XIcVGrOW37mo7IjLgyG-
6KFAy_51418/export?format=txt 
https://zspbialobrzegi.edu.pl/html/plany/s14.php
```

## CONCLUSI√ìN 
Tras el an√°lisis realizado, se ha podido comprobar la relaci√≥n de Bizarro con el troyano Mekotio, confirmando as√≠ que se trata de otro malware procedente de sudam√©rica al igual que otros como Guildma, Javali, Melcoz, Grandoreiro y Amavaldo, con los que comparte caracter√≠sticas como el uso del lenguaje Delphi y los cuales han comenzado a expandir sus operaciones a pa√≠ses europeos.

En cuanto a Bizarro, destacan las medidas tomadas por los atacantes para dificultar el an√°lisis como el cifrado de cadenas de caracteres y los diferentes medios t√©cnicos implementados para llevar a cabo ataques de ingenier√≠a social que maximicen el impacto de la amenaza.

## REFERENCIAS 
- <a href="https://securelist.lat/bizarro-banking-trojan-expands-its-attacks-to-europe/93679/" target="_blank">https://securelist.lat/bizarro-banking-trojan-expands-its-attacks-to-europe/93679/</a> 
- <a href="https://www.fortinet.com/blog/threat-research/another-metamorfo-variant-targeting-customers-of-financial-institutions" target="_blank">https://www.fortinet.com/blog/threat-research/another-metamorfo-variant-targeting-customers-of-financial-institutions</a> 
- <a href="https://securityboulevard.com/2020/09/rooty-dolphin-uses-mekotio-to-target-bank-clients-in-south-america-and-europe/" target="_blank">https://securityboulevard.com/2020/09/rooty-dolphin-uses-mekotio-to-target-bank-clients-in-south-america-and-europe/</a>
- <a href="https://www.incibe.es/sites/default/files/contenidos/estudios/doc/incibe-cert_estudio_analisis_mekotio_2021_v1.pdf" target="_blank">https://www.incibe.es/sites/default/files/contenidos/estudios/doc/incibe-cert_estudio_analisis_mekotio_2021_v1.pdf</a> 
- <a href="https://frontech.com.co/amd/uploads/2020_Mekotio_Troyanos_bancarios_al_acecho_investigaci%C3%B3n_ESET.pdf" target="_blank">https://frontech.com.co/amd/uploads/2020_Mekotio_Troyanos_bancarios_al_acecho_investigaci%C3%B3n_ESET.pdf</a>